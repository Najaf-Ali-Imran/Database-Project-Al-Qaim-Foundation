<Page x:Class="AlQaim.LT_GenerateTestReport"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:AlQaim"
      mc:Ignorable="d"
      d:DesignHeight="750" d:DesignWidth="1100" 
    Title="Generate Test Report">

    <Page.Resources>
        <!-- Brushes -->
        <SolidColorBrush x:Key="PrimaryBackColor" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="SecondaryBackColor" Color="#F4F7FE"/>
        <SolidColorBrush x:Key="PrimaryAccentColor" Color="#4361EE"/>
        <SolidColorBrush x:Key="SecondaryAccentColor" Color="#3A0CA3"/>
        <SolidColorBrush x:Key="TextColor" Color="#333333"/>
        <SolidColorBrush x:Key="BorderColor" Color="#E1E5EB"/>
        <SolidColorBrush x:Key="LightGrayColor" Color="#F2F2F2"/>
        <SolidColorBrush x:Key="GrayTextColor" Color="#888888"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#10B981"/>
        <SolidColorBrush x:Key="WarningColor" Color="#F59E0B"/>
        <SolidColorBrush x:Key="DangerColor" Color="#EF4444"/>
        <SolidColorBrush x:Key="InfoColor" Color="#3B82F6"/>
        <SolidColorBrush x:Key="WhiteBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="PlaceholderGrayColor" Color="#AAAAAA"/>

   
        <!-- Style for ComboBox Toggle Button (Required by ModernComboBox) -->
        <Style x:Key="ComboBoxToggleButtonSimpleStyle" TargetType="{x:Type ToggleButton}">
            <Setter Property="OverridesDefaultStyle" Value="true"/>
            <Setter Property="IsTabStop" Value="false"/>
            <Setter Property="Focusable" Value="false"/>
            <Setter Property="ClickMode" Value="Press"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border x:Name="templateRoot" Background="Transparent" BorderBrush="{Binding BorderBrush, RelativeSource={RelativeSource AncestorType=ComboBox}}" BorderThickness="{Binding BorderThickness, RelativeSource={RelativeSource AncestorType=ComboBox}}" CornerRadius="6" SnapsToDevicePixels="true">
                            <Border x:Name="splitBorder" BorderThickness="0" HorizontalAlignment="Right" Margin="0,0,5,0" SnapsToDevicePixels="true" Width="20">
                                <Path x:Name="arrow" Data="F1 M 0,0 L 4,4 L 8,0 Z" Fill="{StaticResource GrayTextColor}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Fill" TargetName="arrow" Value="#BFBFBF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Button -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryAccentColor}"/>
            <Setter Property="Foreground" Value="{StaticResource WhiteBrush}"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource SecondaryAccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource PrimaryAccentColor}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Secondary Button -->
        <Style x:Key="ModernSecondaryButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="{StaticResource WhiteBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource LightGrayColor}"/>
                    <Setter Property="Effect" Value="{x:Null}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="{StaticResource BorderColor}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Modern Text Button (for Clear) -->
        <Style x:Key="ModernTextButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryAccentColor}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <ContentPresenter x:Name="contentPresenter" Focusable="False"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                          RecognizesAccessKey="True"/>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="{StaticResource SecondaryAccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Foreground" Value="{StaticResource SecondaryAccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern TextBox -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Background" Value="{StaticResource PrimaryBackColor}"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor}"/>
            <Setter Property="Validation.ErrorTemplate" Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6" SnapsToDevicePixels="True">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden" Margin="1"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Opacity" TargetName="border" Value="0.56"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="BorderBrush" TargetName="border" Value="{StaticResource PrimaryAccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="true">
                                <Setter Property="BorderBrush" TargetName="border" Value="{StaticResource PrimaryAccentColor}"/>
                                <Setter Property="Background" Value="{StaticResource PrimaryBackColor}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern ComboBox -->
        <Style x:Key="ModernComboBox" TargetType="ComboBox">
            <Setter Property="Padding" Value="10,0,30,0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Background" Value="{StaticResource PrimaryBackColor}"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid x:Name="templateRoot" SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" Width="0"/>
                            </Grid.ColumnDefinitions>
                            <Popup x:Name="PART_Popup" AllowsTransparency="true" Grid.ColumnSpan="2" IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}" PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}" Placement="Bottom">
                                <Border x:Name="dropDownBorder" Background="{StaticResource PrimaryBackColor}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="6" MaxHeight="{TemplateBinding MaxDropDownHeight}" Margin="0,5,0,0">
                                    <ScrollViewer x:Name="DropDownScrollViewer">
                                        <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Contained" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                            <ToggleButton x:Name="toggleButton" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Grid.ColumnSpan="2" IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Style="{StaticResource ComboBoxToggleButtonSimpleStyle}"/>
                            <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Content="{TemplateBinding SelectionBoxItem}" ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" IsHitTestVisible="false" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEditable" Value="true"/>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="BorderBrush" TargetName="toggleButton" Value="{StaticResource PrimaryAccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocusWithin" Value="true">
                                <Setter Property="BorderBrush" TargetName="toggleButton" Value="{StaticResource PrimaryAccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Field Label -->
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor}"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <!-- Section Header -->
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource SecondaryAccentColor}"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Setter Property="FontSize" Value="18"/>
        </Style>

        <!-- Card Panel -->
        <Style x:Key="CardPanel" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource PrimaryBackColor}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="25"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="15" ShadowDepth="2" Opacity="0.08" Color="#555555"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern CheckBox -->
        <Style x:Key="ModernCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource TextColor}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Background" Value="{StaticResource PrimaryBackColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5,0,0,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid x:Name="templateRoot" Background="Transparent" SnapsToDevicePixels="True">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="checkBoxBorder" Grid.Column="0" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" CornerRadius="3" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="1" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Width="16" Height="16">
                                <Path x:Name="optionMark" Data="F1 M 3.5,7 L 6.5,10 L 12.5,4" Stroke="{StaticResource PrimaryAccentColor}" StrokeThickness="2" SnapsToDevicePixels="False" StrokeEndLineCap="Round" StrokeStartLineCap="Round" Stretch="Uniform" Visibility="Collapsed"/>
                            </Border>
                            <ContentPresenter x:Name="contentPresenter" Grid.Column="1" Focusable="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasContent" Value="true">
                                <Setter Property="FocusVisualStyle">
                                    <Setter.Value>
                                        <Style>
                                            <Setter Property="Control.Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <Rectangle Margin="2" SnapsToDevicePixels="true" Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" StrokeThickness="1" StrokeDashArray="1 2"/>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Padding" Value="4,-1,0,0"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="BorderBrush" TargetName="checkBoxBorder" Value="{StaticResource PrimaryAccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter Property="Background" TargetName="checkBoxBorder" Value="{StaticResource LightGrayColor}"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="true">
                                <Setter Property="Visibility" TargetName="optionMark" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="{x:Null}">
                               
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Icon Button -->
        <Style x:Key="ModernIconButton" TargetType="{x:Type Button}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource WhiteBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                SnapsToDevicePixels="true">
                            <ContentPresenter x:Name="contentPresenter" Focusable="False"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Margin="{TemplateBinding Padding}"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                              RecognizesAccessKey="True"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#33FFFFFF"/>
                                <!-- Semi-transparent white -->
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#55FFFFFF"/>
                                <!-- Slightly more opaque -->
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

       
        <Storyboard x:Key="FadeInStoryboard">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.3"/>
        </Storyboard>

    </Page.Resources>

    <Grid Background="{StaticResource SecondaryBackColor}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <Grid Grid.Row="0" Margin="30,25,30,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0">
                <TextBlock Text="Generate Test Report" FontSize="24" FontWeight="Bold" Foreground="{StaticResource TextColor}" Margin="0,0,0,5"/>
                <TextBlock Text="Select samples, configure options, and generate reports" FontSize="14" Foreground="{StaticResource GrayTextColor}"/>
            </StackPanel>
            <Border Grid.Column="1" Background="{StaticResource PrimaryAccentColor}" CornerRadius="6" Padding="15,8" VerticalAlignment="Center" Height="40">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Today: " Foreground="{StaticResource WhiteBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="CurrentDateText" Text="{Binding CurrentDate, StringFormat='{}{0:MMMM dd, yyyy}'}" Foreground="{StaticResource WhiteBrush}" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Main Content Area -->
        <Grid Grid.Row="1" Margin="30,0,30,30">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/>
           
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Sample Selection -->
            <Border Grid.Column="0" Style="{StaticResource CardPanel}" Margin="0,0,15,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Sample Selection" Style="{StaticResource SectionHeader}" Margin="0,0,0,10"/>

                    <!-- Search Box -->
                    <Grid Grid.Row="1" Margin="0,0,0,15">
                        <TextBox x:Name="SearchBox" Style="{StaticResource ModernTextBox}"
                                 TextChanged="SearchBox_TextChanged"
                                 GotFocus="SearchBox_GotFocus"
                                 LostFocus="SearchBox_LostFocus"
                                 Tag="Search samples..."/>
                        <!-- Search Icon Overlay -->
                        <TextBlock Text="" FontFamily="Segoe MDL2 Assets" Foreground="{StaticResource PlaceholderGrayColor}"
                                   FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="259,0,0,0"
                                   IsHitTestVisible="False"/>
                    </Grid>

                    <!-- Sample List -->
                    <Border Grid.Row="2" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="6" Background="{StaticResource WhiteBrush}">
                        <ListView x:Name="SampleListView"
                                  ItemsSource="{Binding FilteredSamples}"
                                  BorderThickness="0"
                                  Background="Transparent"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                                  AlternationCount="2">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    <Setter Property="Padding" Value="0"/>
                                    
                                    <Setter Property="Margin" Value="0"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                                    <Setter Property="Background" Value="{Binding RelativeSource={RelativeSource Self}, Path=AlternationIndex, Converter={StaticResource AlternatingRowBackgroundConverter}}"/>
                                    <Style.Triggers>
                                        <MultiTrigger>
                                            <MultiTrigger.Conditions>
                                                <Condition Property="IsMouseOver" Value="True" />
                                                <Condition Property="IsSelected" Value="False" />
                                            </MultiTrigger.Conditions>
                                            <Setter Property="Background" Value="{StaticResource LightGrayColor}"/>
                                        </MultiTrigger>
                                    
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemTemplate>
                                <DataTemplate DataType="{x:Type local:SampleViewModel}">
                                    <Grid Margin="15,10">
                                     
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                       
                                        <CheckBox Grid.Column="0"
                                                  IsChecked="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  VerticalAlignment="Center" Margin="0,0,15,0"
                                                  Style="{StaticResource ModernCheckBox}"
                                                  Click="SampleCheckBox_Click"/>
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding SampleId}" FontWeight="SemiBold" Foreground="{StaticResource TextColor}"/>
                                            <TextBlock Text="{Binding PatientName}" Foreground="{StaticResource GrayTextColor}" FontSize="12"/>
                                            <TextBlock Text="{Binding CollectionDate, StringFormat='Collected: {0:MM/dd/yyyy}'}"
                                                       FontSize="11" Foreground="{StaticResource GrayTextColor}" Opacity="0.8"/>
                                        </StackPanel>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Border>

                    <!-- Selection Info -->
                    <Grid Grid.Row="3" Margin="0,15,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" x:Name="SelectedCountText" Text="0 samples selected" VerticalAlignment="Center"
                                   Foreground="{StaticResource GrayTextColor}"/>
                        <Button Grid.Column="1" Content="Clear Selection" Style="{StaticResource ModernTextButton}" Click="ClearSelection_Click"/>
                    </Grid>
                </Grid>
            </Border>

            <!-- Right Panel: Configuration & Preview -->
            <Grid Grid.Column="1" Margin="15,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                   
                    <RowDefinition Height="*"/>
                  
                    <RowDefinition Height="Auto"/>
                   
                </Grid.RowDefinitions>

                <!-- Configuration Panel -->
                <Border Grid.Row="0" Style="{StaticResource CardPanel}" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="Report Configuration" Style="{StaticResource SectionHeader}" Margin="0,0,0,10"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Report Type & Format -->
                            <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,15">
                                <TextBlock Text="Report Type" Style="{StaticResource FieldLabel}"/>
                                <ComboBox x:Name="ReportTypeComboBox" Style="{StaticResource ModernComboBox}" SelectedIndex="0">
                                    <ComboBoxItem Content="Standard Report"/>
                                    <ComboBoxItem Content="Detailed Report"/>
                                    <ComboBoxItem Content="Summary Report"/>
                                </ComboBox>
                            </StackPanel>
                            <StackPanel Grid.Row="0" Grid.Column="1" Margin="10,0,0,15">
                                <TextBlock Text="Report Format" Style="{StaticResource FieldLabel}"/>
                                <ComboBox x:Name="ReportFormatComboBox" Style="{StaticResource ModernComboBox}" SelectedIndex="0">
                                    <ComboBoxItem Content="PDF Document"/>
                                    <ComboBoxItem Content="CSV Spreadsheet"/>
                                    <ComboBoxItem Content="Excel Workbook"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Include Options -->
                            <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                    Background="{StaticResource SecondaryBackColor}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1"
                                    CornerRadius="8" Padding="15" Margin="0,0,0,20">
                                <StackPanel>
                                    <TextBlock Text="Include in Report" FontWeight="SemiBold" Margin="0,0,0,10" Foreground="{StaticResource TextColor}"/>
                                    <UniformGrid Columns="2">
                                        <CheckBox x:Name="IncludeLogoCheckBox" Content="Lab Logo" Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="0,5"/>
                                        <CheckBox x:Name="IncludeSignatureCheckBox" Content="Signature Line" Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="10,5,0,5"/>
                                        <CheckBox x:Name="IncludeRefRangesCheckBox" Content="Reference Ranges" Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="0,5"/>
                                        <CheckBox x:Name="IncludeMethodDetailsCheckBox" Content="Test Method Details" Style="{StaticResource ModernCheckBox}" IsChecked="False" Margin="10,5,0,5"/>
                                        <CheckBox x:Name="IncludePreviousResultsCheckBox" Content="Previous Results" Style="{StaticResource ModernCheckBox}" IsChecked="False" Margin="0,5"/>
                                        <CheckBox x:Name="IncludeNotesCheckBox" Content="Notes and Comments" Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="10,5,0,5"/>
                                    </UniformGrid>
                                </StackPanel>
                            </Border>

                            <!-- Generate Button -->
                            <Button Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" x:Name="GenerateButton" Content="Generate Report"
                                    Style="{StaticResource ModernButton}"
                                    Click="GenerateReport_Click" IsEnabled="False" HorizontalAlignment="Stretch"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Preview Panel -->
                <Border Grid.Row="1" Style="{StaticResource CardPanel}" Margin="0,0,0,15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Preview Header -->
                        <Border Grid.Row="0" Background="{StaticResource PrimaryAccentColor}" CornerRadius="6,6,0,0" Padding="15" Margin="-26,-26,-26,15">
                            <!-- Negative margin pulls it to card edges -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Report Preview" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource WhiteBrush}" VerticalAlignment="Center"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button x:Name="RefreshButton" Style="{StaticResource ModernIconButton}" ToolTip="Refresh Preview" Margin="0,0,5,0" Click="RefreshPreview_Click">
                                        <TextBlock Text="" />
                                        <!-- Refresh Icon -->
                                    </Button>
                                    <Button x:Name="FullScreenButton" Style="{StaticResource ModernIconButton}" ToolTip="Full Screen Preview" Click="FullScreen_Click">
                                        <TextBlock Text="" />
                                        <!-- Full Screen Icon -->
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Preview Content Area -->
                        <Border Grid.Row="1" Background="{StaticResource WhiteBrush}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="6">
                            <ScrollViewer x:Name="ReportScrollViewer" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                                <Grid x:Name="ReportPreviewContainer" Margin="10">
                                    <!-- Empty State -->
                                    <Border x:Name="NoReportPlaceholder" Background="{StaticResource SecondaryBackColor}" Padding="30" Margin="20" CornerRadius="8">
                                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <TextBlock Text="" FontFamily="Segoe MDL2 Assets" FontSize="48" HorizontalAlignment="Center"
                                                       Foreground="{StaticResource PlaceholderGrayColor}" Opacity="0.8"/>
                                            <TextBlock Text="No Report Generated" FontSize="16" FontWeight="SemiBold" HorizontalAlignment="Center"
                                                       Margin="0,15,0,10" Foreground="{StaticResource TextColor}"/>
                                            <TextBlock Text="Select samples, configure options, and click 'Generate Report' to preview it here."
                                                       TextWrapping="Wrap" TextAlignment="Center" MaxWidth="400"
                                                       Foreground="{StaticResource GrayTextColor}" Opacity="0.9"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Report Content (Copy structure from previous version, styling updated implicitly via resources) -->
                                    <Grid x:Name="ReportContent" Visibility="Collapsed">
                                        <!-- Copied structure - Minor adjustments for spacing/labels -->
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <!-- Lab Header -->
                                        <Grid Grid.Row="0" Margin="20,20,20,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Grid.Column="0" Width="80" Height="40" Background="{StaticResource LightGrayColor}" CornerRadius="4">
                                                <TextBlock Text="LOGO" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Foreground="{StaticResource GrayTextColor}" Opacity="0.7"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="15,0">
                                                <TextBlock Text="CENTRAL LABORATORY SERVICES" FontSize="16" FontWeight="Bold"/>
                                                <TextBlock Text="123 Medical Center Dr" HorizontalAlignment="Center" Margin="0,3,0,0" Opacity="0.8"/>
                                                <TextBlock Text="555-123-4567 | lab@example.com" HorizontalAlignment="Center" Margin="0,2,0,0" Opacity="0.7" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                                <TextBlock Text="TEST REPORT" FontWeight="Bold" HorizontalAlignment="Right"/>
                                                <TextBlock x:Name="ReportDateText" Text="Date: MM/DD/YY" HorizontalAlignment="Right" Margin="0,3,0,0" FontSize="11"/>
                                                <TextBlock x:Name="ReportIdText" Text="ID: LAB-XXXX" HorizontalAlignment="Right" Margin="0,2,0,0" FontSize="11"/>
                                            </StackPanel>
                                        </Grid>
                                        <!-- Divider -->
                                        <Separator Grid.Row="1" Margin="20,0,20,10" Background="{StaticResource BorderColor}"/>
                                        <!-- Patient & Sample Info -->
                                        <Border Grid.Row="2" Padding="10,0,10,10" Margin="20,0,20,15">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid Grid.Column="0">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <StackPanel Grid.Row="0">
                                                        <TextBlock Text="PATIENT" FontWeight="SemiBold" Foreground="{StaticResource PrimaryAccentColor}" Margin="0,0,0,5" FontSize="12"/>
                                                        <Grid Margin="0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Name:" Style="{StaticResource FieldLabel}" Margin="0,0,0,4" FontSize="12"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="PatientNameText" Text="[...]" Margin="5,0,10,4" VerticalAlignment="Center" FontSize="12"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="2" Text="DOB:" Style="{StaticResource FieldLabel}" Margin="0,0,0,4" FontSize="12"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="3" x:Name="PatientDobText" Text="[...]" Margin="5,0,0,4" VerticalAlignment="Center" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Gender:" Style="{StaticResource FieldLabel}" Margin="0,0,0,0" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="PatientGenderText" Text="[...]" Margin="5,0,10,0" VerticalAlignment="Center" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="2" Text="Patient ID:" Style="{StaticResource FieldLabel}" Margin="0,0,0,0" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="3" x:Name="PatientIdText" Text="[...]" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                                                        </Grid>
                                                    </StackPanel>
                                                    <StackPanel Grid.Row="1" Margin="0,8,0,0">
                                                        <TextBlock Text="SAMPLE" FontWeight="SemiBold" Foreground="{StaticResource PrimaryAccentColor}" Margin="0,0,0,5" FontSize="12"/>
                                                        <Grid Margin="0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Sample ID:" Style="{StaticResource FieldLabel}" Margin="0,0,0,4" FontSize="12"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="SampleIdText" Text="[...]" Margin="5,0,10,4" VerticalAlignment="Center" FontSize="12"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="2" Text="Type:" Style="{StaticResource FieldLabel}" Margin="0,0,0,4" FontSize="12"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="3" x:Name="SampleTypeText" Text="[...]" Margin="5,0,0,4" VerticalAlignment="Center" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Collected:" Style="{StaticResource FieldLabel}" Margin="0,0,0,0" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="CollectionDateText" Text="[...]" Margin="5,0,10,0" VerticalAlignment="Center" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="2" Text="Received:" Style="{StaticResource FieldLabel}" Margin="0,0,0,0" FontSize="12"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="3" x:Name="ReceivedDateText" Text="[...]" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Grid>
                                                <Border Grid.Column="1" Width="70" Height="70" Background="White" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="4" Margin="15,0,0,0" VerticalAlignment="Center">
                                                    <TextBlock Text="QR" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{StaticResource GrayTextColor}" Opacity="0.5"/>
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <!-- Test Results Table -->
                                        <Border Grid.Row="3" Margin="20,0,20,15">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <TextBlock Grid.Row="0" Text="TEST RESULTS" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{StaticResource PrimaryAccentColor}" FontSize="12"/>
                                                <Border Grid.Row="1" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="4">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Border Grid.Row="0" Background="{StaticResource SecondaryBackColor}" Padding="10,8" CornerRadius="4,4,0,0" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="90"/>
                                                                    <ColumnDefinition Width="70"/>
                                                                    <ColumnDefinition Width="120"/>
                                                                    <ColumnDefinition Width="80"/>
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="Test Name" FontWeight="SemiBold"/>
                                                                <TextBlock Grid.Column="1" Text="Result" FontWeight="SemiBold" TextAlignment="Right"/>
                                                                <TextBlock Grid.Column="2" Text="Units" FontWeight="SemiBold" Margin="5,0,0,0"/>
                                                                <TextBlock Grid.Column="3" Text="Reference Range" FontWeight="SemiBold" Margin="5,0,0,0"/>
                                                                <TextBlock Grid.Column="4" Text="Status" FontWeight="SemiBold" TextAlignment="Center"/>
                                                            </Grid>
                                                        </Border>
                                                        <ItemsControl Grid.Row="1" x:Name="TestResultsItemsControl">
                                                            <ItemsControl.ItemTemplate>
                                                                <DataTemplate DataType="{x:Type local:TestResult}">
                                                                    <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" Padding="10,10">
                                                                        <Grid>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="*"/>
                                                                                <ColumnDefinition Width="90"/>
                                                                                <ColumnDefinition Width="70"/>
                                                                                <ColumnDefinition Width="120"/>
                                                                                <ColumnDefinition Width="80"/>
                                                                            </Grid.ColumnDefinitions>
                                                                            <TextBlock Grid.Column="0" Text="{Binding TestName}" VerticalAlignment="Center"/>
                                                                            <TextBlock Grid.Column="1" Text="{Binding Result}" VerticalAlignment="Center" TextAlignment="Right"/>
                                                                            <TextBlock Grid.Column="2" Text="{Binding Units}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                                                                            <TextBlock Grid.Column="3" Text="{Binding ReferenceRange}" VerticalAlignment="Center" Margin="5,0,0,0" FontSize="11"/>
                                                                            <Border Grid.Column="4" Background="{Binding StatusColor}" CornerRadius="4" Padding="6,2" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                                                <TextBlock Text="{Binding Status}" FontSize="10" FontWeight="SemiBold" Foreground="White" TextAlignment="Center"/>
                                                                            </Border>
                                                                        </Grid>
                                                                    </Border>
                                                                </DataTemplate>
                                                            </ItemsControl.ItemTemplate>
                                                            <!-- Sample data for design-time preview -->
                                                            <ItemsControl.Items>
                                                                <local:TestResult TestName="Hemoglobin" Result="15.2" Units="g/dL" ReferenceRange="13.5 - 17.5" Status="Normal" StatusColor="{StaticResource SuccessColor}"/>
                                                                <local:TestResult TestName="WBC Count" Result="10.8" Units="10³/µL" ReferenceRange="4.5 - 10.5" Status="High" StatusColor="{StaticResource WarningColor}"/>
                                                                <local:TestResult TestName="Platelets" Result="220" Units="10³/µL" ReferenceRange="150 - 450" Status="Normal" StatusColor="{StaticResource SuccessColor}"/>
                                                            </ItemsControl.Items>
                                                        </ItemsControl>
                                                    </Grid>
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <!-- Comments & Signature -->
                                        <Grid Grid.Row="4" Margin="20,0,20,20">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <StackPanel Grid.Row="0" Margin="0,0,0,10">
                                                <TextBlock Text="COMMENTS" FontWeight="SemiBold" Margin="0,0,0,5" Foreground="{StaticResource PrimaryAccentColor}" FontSize="12"/>
                                                <Border Background="{StaticResource SecondaryBackColor}" Padding="10" CornerRadius="4" MinHeight="40" BorderBrush="{StaticResource BorderColor}" BorderThickness="1">
                                                    <TextBlock x:Name="CommentsText" Text="[...]" TextWrapping="Wrap"/>
                                                </Border>
                                            </StackPanel>
                                            <TextBlock Grid.Row="1" TextWrapping="Wrap" Margin="0,5,0,15" FontSize="9" Foreground="{StaticResource GrayTextColor}" Opacity="0.8">Disclaimer: For interpretation by qualified healthcare professionals only. Ranges may vary.</TextBlock>
                                            <Grid Grid.Row="2">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                                    <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" Padding="0,0,0,5" Margin="0,10,30,5">
                                                        <TextBlock Text="" MinHeight="18"/>
                                                    </Border>
                                                    <TextBlock x:Name="LabDirectorText" Text="[Director Name]" FontWeight="SemiBold" FontSize="11"/>
                                                    <TextBlock Text="Laboratory Director" FontSize="10" Opacity="0.8"/>
                                                </StackPanel>
                                                <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                                    <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" Padding="0,0,0,5" Margin="0,10,30,5">
                                                        <TextBlock Text="" MinHeight="18"/>
                                                    </Border>
                                                    <TextBlock x:Name="TechnicianText" Text="[Technician Name]" FontWeight="SemiBold" FontSize="11"/>
                                                    <TextBlock Text="Testing Technician" FontSize="10" Opacity="0.8"/>
                                                </StackPanel>
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                    <!-- End ReportContent -->
                                </Grid>
                            </ScrollViewer>
                        </Border>
                    </Grid>
                </Border>

                <!-- Action Buttons Panel -->
                <Border Grid.Row="2" Style="{StaticResource CardPanel}" Padding="20,15">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <!-- Status -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock x:Name="ReportStatusIcon" Text="" FontFamily="Segoe MDL2 Assets" Foreground="{StaticResource InfoColor}" VerticalAlignment="Center" Margin="0,0,8,0" FontSize="16"/>
                            <TextBlock x:Name="ReportStatusText" Text="Ready to generate report" Margin="0,0,0,0" Foreground="{StaticResource TextColor}" VerticalAlignment="Center"/>
                        </StackPanel>
                        <!-- Buttons -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="PrintButton" Style="{StaticResource ModernSecondaryButton}" Margin="0,0,10,0" Padding="10,8" Click="PrintReport_Click" IsEnabled="False" Height="36">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="" FontFamily="Segoe MDL2 Assets" VerticalAlignment="Center" FontSize="14"/>
                                    <TextBlock Text="Print" Margin="6,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="ExportButton" Style="{StaticResource ModernSecondaryButton}" Margin="0,0,10,0" Padding="10,8" Click="ExportReport_Click" IsEnabled="False" Height="36">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="" FontFamily="Segoe MDL2 Assets" VerticalAlignment="Center" FontSize="14"/>
                                    <TextBlock Text="Export" Margin="6,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="EmailButton" Style="{StaticResource ModernButton}" Padding="10,8" Click="EmailReport_Click" IsEnabled="False" Height="36">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="" FontFamily="Segoe MDL2 Assets" VerticalAlignment="Center" FontSize="14"/>
                                    <TextBlock Text="Email Report" Margin="6,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

            </Grid>

        </Grid>

    </Grid>
</Page>