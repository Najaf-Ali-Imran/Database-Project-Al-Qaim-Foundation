<Page x:Class="AlQaim.Admin_Dashboard"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
      xmlns:fa="http://schemas.awesome.incremented/wpf/xaml/fontawesome.sharp"
      xmlns:local="clr-namespace:AlQaim"
      mc:Ignorable="d"
      d:DesignHeight="950" d:DesignWidth="1200"
      Title="Admin Dashboard"
      Background="#F5F8FA">

    <Page.Resources>
      
        <SolidColorBrush x:Key="PrimaryBackground" Color="#F5F8FA"/>
        <SolidColorBrush x:Key="SecondaryBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="CardBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="AccentColor" Color="#2E86DE"/>
        <SolidColorBrush x:Key="AccentColorLight" Color="#54A0FF"/>
        <SolidColorBrush x:Key="AccentColorDark" Color="#0063B1"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#26de81"/>
        <SolidColorBrush x:Key="WarningColor" Color="#F79F1F"/>
        <SolidColorBrush x:Key="DangerColor" Color="#FC5C65"/>
        <SolidColorBrush x:Key="InfoColor" Color="#45aaf2"/>
        <SolidColorBrush x:Key="AppointmentColor" Color="#8e44ad"/>
        <SolidColorBrush x:Key="AppointmentColorLight" Color="#9b59b6"/>


        <SolidColorBrush x:Key="AccentColorLightBackground" Color="#EBF5FF"/>
        <SolidColorBrush x:Key="WarningColorLightBackground" Color="#FFF6E5"/>
        <SolidColorBrush x:Key="SuccessColorLightBackground" Color="#E3FCEF"/>
        <SolidColorBrush x:Key="DangerColorLightBackground" Color="#FFE6E9"/>
        <SolidColorBrush x:Key="InfoColorLightBackground" Color="#E4F6FD"/>
        <SolidColorBrush x:Key="AppointmentColorLightBackground" Color="#F4ECF7"/>

        <SolidColorBrush x:Key="TabBorderBrushSelected" Color="#2e86de"/>
        <SolidColorBrush x:Key="TabBorderBrushNormal" Color="Transparent"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#2D3436"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#636E72"/>
        <SolidColorBrush x:Key="BorderColor" Color="#E6ECF0"/>
        <SolidColorBrush x:Key="NotesBackground" Color="#FDFEFE"/>
        <SolidColorBrush x:Key="TaskCompletedColor" Color="#E3FCEF"/>
        <SolidColorBrush x:Key="TaskPendingColor" Color="#FFF6E5"/>
        <SolidColorBrush x:Key="TaskHighPriorityColor" Color="#FFE6E9"/>
        <SolidColorBrush x:Key="TaskMediumPriorityColor" Color="#FFF6E5"/>
        <SolidColorBrush x:Key="TaskLowPriorityColor" Color="#EBF5FF"/>


        <!-- Text Styles -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Semibold"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
        <Style x:Key="SubHeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Semibold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        <Style x:Key="SectionTitleStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Medium"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        <Style x:Key="BodyTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="LineHeight" Value="18"/>
        </Style>
        <Style x:Key="MetricTitleStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Medium"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
        </Style>
        <Style x:Key="MetricValueStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Bold"/>
            <Setter Property="FontSize" Value="32"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Margin" Value="0,8,0,5"/>
        </Style>

        <!-- Card Style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackground}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="15" ShadowDepth="1" Direction="270" Opacity="0.08" Color="#000000"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Rounded Button Style -->
        <Style x:Key="ModernHeaderButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentColor}"/>
            <Setter Property="Foreground" Value="{StaticResource SecondaryBackground}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="12,7"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="15" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentColorLight}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentColorDark}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Subtle Button Style -->
        <Style x:Key="SubtleButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernHeaderButtonStyle}">
            <Setter Property="Background" Value="{StaticResource AccentColorLight}"/>
            <Setter Property="Foreground" Value="{StaticResource AccentColorDark}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentColor}"/>
                    <Setter Property="Foreground" Value="{StaticResource SecondaryBackground}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentColorDark}"/>
                    <Setter Property="Foreground" Value="{StaticResource SecondaryBackground}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Modern Rounded ComboBox Style -->
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{StaticResource SecondaryBackground}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <Border x:Name="MainBorder" CornerRadius="15" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition MinWidth="20" Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                                    <ToggleButton x:Name="ToggleButton" Grid.Column="1" Style="{x:Null}" IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Focusable="False" ClickMode="Press" Background="Transparent" BorderBrush="Transparent">
                                        <Path x:Name="Arrow" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" Fill="{StaticResource TextSecondary}" Data="M 0 0 L 4 4 L 8 0 Z" Margin="0,0,8,0"/>
                                    </ToggleButton>
                                </Grid>
                            </Border>
                            <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                <Grid x:Name="DropDown" SnapsToDevicePixels="True" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder" Background="{StaticResource SecondaryBackground}" BorderThickness="1" CornerRadius="5" Margin="0,2,0,0" BorderBrush="{StaticResource BorderColor}">
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" ShadowDepth="1" Direction="270" Opacity="0.1" Color="#000000"/>
                                        </Border.Effect>
                                        <ScrollViewer SnapsToDevicePixels="True">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="MainBorder" Property="BorderBrush" Value="{StaticResource AccentColorLight}"/>
                                <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource AccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsDropDownOpen" Value="True">
                                <Setter TargetName="MainBorder" Property="BorderBrush" Value="{StaticResource AccentColor}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Activity/Notification Item Style -->
        <Style x:Key="ListItemStyle" TargetType="Border">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>

        <!-- Animation Storyboards -->
        <Storyboard x:Key="FadeInStoryboard">
            <DoubleAnimation From="0" To="1" Duration="0:0:0.4" Storyboard.TargetProperty="Opacity">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <!-- Modern Scrollbar Styles -->
        <Style TargetType="{x:Type RepeatButton}">
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <Rectangle Fill="{TemplateBinding Background}" Height="{TemplateBinding Height}" Width="{TemplateBinding Width}"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ModernScrollBarThumb" TargetType="{x:Type Thumb}">
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Border x:Name="thumbBorder" Background="{StaticResource AccentColor}" BorderBrush="Transparent" BorderThickness="0" CornerRadius="6" SnapsToDevicePixels="True"/>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="thumbBorder" Property="Background" Value="{StaticResource AccentColorLight}"/>
                            </Trigger>
                            <Trigger Property="IsDragging" Value="True">
                                <Setter TargetName="thumbBorder" Property="Background" Value="{StaticResource AccentColorDark}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsPressAndHoldEnabled" Value="False"/>
            <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="12"/>
            <Setter Property="MinWidth" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid SnapsToDevicePixels="True" Background="{TemplateBinding Background}">
                            <Track x:Name="PART_Track" IsDirectionReversed="True" Opacity="0">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageUpCommand}"/>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageDownCommand}"/>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource ModernScrollBarThumb}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="PART_Track" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="PART_Track" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.3"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Orientation" Value="Vertical">
                    <Setter Property="Width" Value="12"/>
                    <Setter Property="Height" Value="Auto" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style for Task Item Action Buttons -->
        <Style x:Key="TaskActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="Width" Value="28"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="Margin" Value="2,0"/>
            <Setter Property="ToolTipService.ShowDuration" Value="20000"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="14" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#EBF5FF"/>
                                <Setter Property="Foreground" Value="{StaticResource AccentColor}"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="Edit">
                                <Setter Property="ToolTip" Value="Edit Task"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="Delete">
                                <Setter Property="ToolTip" Value="Delete Task"/>
                                <Setter Property="Foreground" Value="{StaticResource DangerColor}"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="Tag" Value="Delete"/>
                                </MultiTrigger.Conditions>
                                <MultiTrigger.Setters>
                                    <Setter TargetName="border" Property="Background" Value="#FFF0F1"/>
                                    <Setter Property="Foreground" Value="{StaticResource DangerColor}"/>
                                </MultiTrigger.Setters>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <!-- Main Grid Layout -->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="340"/>
        </Grid.ColumnDefinitions>

        <!-- === Main Content Area === -->
        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel Margin="20,20,15,20">

                <!-- 1. Header Section -->
                <StackPanel Orientation="Vertical" Margin="0,0,0,15">
                    <TextBlock Text="Welcome, Admin!" Style="{StaticResource HeaderTextStyle}"/>
                    <TextBlock x:Name="DateTimeText" Text="Loading Date/Time..." Style="{StaticResource BodyTextStyle}" Foreground="{StaticResource TextSecondary}" Opacity="0.8"/>
                </StackPanel>

                <!-- 2. Lab/Test Metrics Section -->
                <Grid Margin="0,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}" x:Name="PendingSamplesCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Pending Samples" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource AccentColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="Vial" Foreground="{StaticResource AccentColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="PendingSamplesCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Awaiting collection" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource CardStyle}" x:Name="PendingResultsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Pending Results" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource WarningColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="ClipboardList" Foreground="{StaticResource WarningColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="PendingResultsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Awaiting result entry" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="2" Style="{StaticResource CardStyle}" x:Name="CompletedTestsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Completed Tests" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource SuccessColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="CheckCircle" Foreground="{StaticResource SuccessColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="CompletedTestsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Finished today" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="3" Style="{StaticResource CardStyle}" x:Name="NewRequestsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="New Requests" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource AccentColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="PlusCircle" Foreground="{StaticResource AccentColorDark}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="NewRequestsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Submitted by technicians" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Patient Metrics Section (Rearranged + Quran Verse) -->
                <Grid Margin="0,-8,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}" x:Name="NewPatientsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="New Patients (Today)" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource SuccessColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="UserPlus" Foreground="{StaticResource SuccessColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="NewPatientsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Registered today" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>

                    <Border Grid.Column="1" Grid.ColumnSpan="2" Style="{StaticResource CardStyle}" x:Name="VerseCard" Background="{StaticResource TextPrimary}">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock Text="وَإِذَا مَرِضْتُ فَهُوَ يَشْفِينِ"
                                        FlowDirection="RightToLeft"
                                        FontFamily="Traditional Arabic, Times New Roman"
                                        FontSize="50"
                                        Foreground="{StaticResource PrimaryBackColor}"
                                        TextAlignment="Center"
                                        Margin="0,0,0,8"/>
                             <TextBlock Text="And He ˹alone˺ heals me when I am sick."
                                        Style="{StaticResource BodyTextStyle}"
                                        TextAlignment="Center"
                                        FontSize="15"
                                        Margin="0,0,0,4" Foreground="{StaticResource PrimaryBackColor}"/>
                            <TextBlock Text="The Poets: 26:80"
                                       Style="{StaticResource BodyTextStyle}"
                                       FontSize="12"
                                       Foreground="{StaticResource PrimaryBackColor}"
                                       TextAlignment="Center"
                                       Opacity="0.8"/>
                         </StackPanel>
                    </Border>

                    <Border Grid.Column="3" Style="{StaticResource CardStyle}" x:Name="TotalPatientsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Total Patients" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource InfoColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="Users" Foreground="{StaticResource InfoColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="TotalPatientsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="All registered records" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>

                </Grid>


                <Grid Margin="0,-8,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}" x:Name="ScheduledApptsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Appts Scheduled" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource AppointmentColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="CalendarPlus" Foreground="{StaticResource AppointmentColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="ScheduledApptsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Scheduled for today" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource CardStyle}" x:Name="CompletedApptsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Appts Completed" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource SuccessColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="CalendarCheck" Foreground="{StaticResource SuccessColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="CompletedApptsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Finished today" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="2" Style="{StaticResource CardStyle}" x:Name="NoShowApptsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Appts No-Shows" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource WarningColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="UserClock" Foreground="{StaticResource WarningColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="NoShowApptsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Missed today" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="3" Style="{StaticResource CardStyle}" x:Name="CancelledApptsCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Appts Cancelled" Style="{StaticResource MetricTitleStyle}"/>
                                <Border Grid.Column="1" Background="{StaticResource DangerColorLightBackground}" CornerRadius="8" Width="40" Height="40">
                                    <fa:IconBlock Icon="CalendarTimes" Foreground="{StaticResource DangerColor}" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <TextBlock Grid.Row="1" x:Name="CancelledApptsCountText" Text="0" Style="{StaticResource MetricValueStyle}"/>
                            <TextBlock Grid.Row="2" Text="Cancelled for today" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Patient Details and Trends Section -->
                <Grid Margin="0,5,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}" x:Name="TopIssuesCard" MinHeight="200">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Style="{StaticResource SubHeaderTextStyle}" Text="Top Operational Issues" Margin="0,0,0,10"/>
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <ItemsControl ItemsSource="{Binding TopIssuesData}" HorizontalContentAlignment="Stretch">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Margin="0,0,0,8">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="{Binding Item1}" Style="{StaticResource BodyTextStyle}" VerticalAlignment="Center"/>
                                                <TextBlock Grid.Column="1" Text="{Binding Item2}" Style="{StaticResource BodyTextStyle}" FontWeight="Medium" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource CardStyle}" x:Name="DiagnosesCard" MinHeight="200">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Style="{StaticResource SubHeaderTextStyle}" Text="Most Diagnosed Conditions"/>
                            <lvc:PieChart Grid.Row="1" Series="{Binding DiagnosesSeries}" LegendLocation="Right" InnerRadius="40" Margin="0,10,-10,5" MinHeight="150">
                                <lvc:PieChart.ChartLegend>
                                    <lvc:DefaultLegend BulletSize="10" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                                </lvc:PieChart.ChartLegend>
                                <lvc:PieChart.DataTooltip>
                                    <lvc:DefaultTooltip BulletSize="12" />
                                </lvc:PieChart.DataTooltip>
                            </lvc:PieChart>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Main Chart Area -->
                <Border Style="{StaticResource CardStyle}" Margin="8,5,8,8" MinHeight="300" x:Name="MainChartCard">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Style="{StaticResource SubHeaderTextStyle}" Text="Daily Test Volume (Last 7 Days)"/>
                            <ComboBox Grid.Column="1" x:Name="ChartTimeRangeComboBox" Style="{StaticResource ModernComboBoxStyle}" Width="130" SelectedIndex="0" Margin="0,0,8,0" SelectionChanged="ChartTimeRange_SelectionChanged" Background="White" >
                                <ComboBoxItem Content="Last 7 Days"/>
                                <ComboBoxItem Content="Last 30 Days"/>
                                <ComboBoxItem Content="Custom Range..."/>
                            </ComboBox>
                        </Grid>
                        <lvc:CartesianChart Grid.Row="1" Series="{Binding DailyTestsSeries}" LegendLocation="Bottom" Margin="0,20,0,5">
                            <lvc:CartesianChart.AxisX>
                                <lvc:Axis Title="Date" Labels="{Binding DailyTestDates}" FontSize="11" Foreground="{StaticResource TextSecondary}"/>
                            </lvc:CartesianChart.AxisX>
                            <lvc:CartesianChart.AxisY>
                                <lvc:Axis Title="Tests Completed" FontSize="11" MinValue="0" Foreground="{StaticResource TextSecondary}"/>
                            </lvc:CartesianChart.AxisY>
                            <lvc:CartesianChart.DataTooltip>
                                <lvc:DefaultTooltip BulletSize="12" />
                            </lvc:CartesianChart.DataTooltip>
                        </lvc:CartesianChart>
                    </Grid>
                </Border>

                <!-- Task Management & Activity Feed in a Grid -->
                <Grid Margin="0,5,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}" Margin="8,0,8,8" x:Name="TasksCard" MinHeight="300">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0" Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                    <fa:IconBlock Icon="Tasks" Foreground="{StaticResource AccentColor}" Width="18" Height="18" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Style="{StaticResource SubHeaderTextStyle}" Text="Assigned Tasks" VerticalAlignment="Center" Margin="0"/>
                                </StackPanel>
                                <Button Grid.Column="1" Style="{StaticResource ModernHeaderButtonStyle}" Click="AddTaskButton_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <fa:IconBlock Icon="Plus" Width="12" Height="12" Margin="0,0,5,0"/>
                                        <TextBlock Text="Add Task" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <ItemsControl x:Name="AdminTasksItemsControl" ItemsSource="{Binding AdminTasks}" HorizontalContentAlignment="Stretch">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" Padding="10,12" Margin="0,0,0,5">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Border Grid.Column="0" Width="5" Height="35" Margin="0,0,15,0" VerticalAlignment="Center" CornerRadius="2.5">
                                                        <Border.Style>
                                                            <Style TargetType="Border">
                                                                <Setter Property="Background" Value="{StaticResource TaskLowPriorityColor}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Priority}" Value="Medium">
                                                                        <Setter Property="Background" Value="{StaticResource WarningColor}"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Priority}" Value="High">
                                                                        <Setter Property="Background" Value="{StaticResource DangerColor}"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                    </Border>
                                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding Title}" FontWeight="Medium" FontSize="13" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,2"/>
                                                        <TextBlock Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.8"><Run Text="Due: "/><Run Text="{Binding DueDate, StringFormat='ddd, MMM dd'}"/><Run Text=" | Assignee: "/><Run Text="{Binding AssigneeName, FallbackValue='Unassigned'}"/><Run Text=" | Status: "/><Run Text="{Binding Status}"/></TextBlock>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                                                        <Button Style="{StaticResource TaskActionButtonStyle}" Tag="Edit" Click="EditTaskButton_Click" CommandParameter="{Binding TaskId}">
                                                            <fa:IconBlock Icon="Edit" FontSize="14"/>
                                                        </Button>
                                                        <Button Style="{StaticResource TaskActionButtonStyle}" Tag="Delete" Click="DeleteTaskButton_Click" CommandParameter="{Binding TaskId}">
                                                            <fa:IconBlock Icon="TrashAlt" FontSize="14"/>
                                                        </Button>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                    <Border Grid.Column="1" Style="{StaticResource CardStyle}" Margin="8,0,8,8" x:Name="ActivityCard" MinHeight="300">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <fa:IconBlock Icon="History" Foreground="{StaticResource InfoColor}" Width="18" Height="18" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Style="{StaticResource SubHeaderTextStyle}" Text="Recent Activity" VerticalAlignment="Center" Margin="0"/>
                            </StackPanel>
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <ItemsControl x:Name="ActivityFeedItemsControl" ItemsSource="{Binding ActivityFeed}" HorizontalContentAlignment="Stretch">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Style="{StaticResource ListItemStyle}">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Border Grid.Column="0" Background="{Binding IconBackground}" Opacity="0.15" CornerRadius="8" Width="36" Height="36" Margin="0,0,15,0">
                                                        <fa:IconBlock Icon="{Binding Icon}" Foreground="{Binding IconForeground}" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding Description}" Style="{StaticResource BodyTextStyle}" FontWeight="Medium" Foreground="{StaticResource TextPrimary}" Margin="0,0,0,2"/>
                                                        <TextBlock Text="{Binding Details}" Style="{StaticResource BodyTextStyle}" FontSize="11" Opacity="0.7"/>
                                                    </StackPanel>
                                                    <TextBlock Grid.Column="2" Text="{Binding Timestamp, StringFormat='HH:mm'}" Style="{StaticResource BodyTextStyle}" FontSize="11" VerticalAlignment="Top" Margin="5,0,0,0" Opacity="0.8"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>

            </StackPanel>
        </ScrollViewer>

        <!-- === Side Panel (Notes) === -->
        <Border Grid.Column="1" Background="{StaticResource SecondaryBackground}" BorderBrush="{StaticResource BorderColor}" BorderThickness="1,0,0,0" >
            <Grid Margin="15,20,15,15">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                    <fa:IconBlock Icon="StickyNote" Foreground="{StaticResource AccentColor}" Width="18" Height="18" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBlock Style="{StaticResource SectionTitleStyle}" Text="Admin Notes"/>
                </StackPanel>
                <Border Grid.Row="1" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="6" Background="{StaticResource NotesBackground}" Padding="2">
                    <TextBox x:Name="AdminNotesTextBox" BorderThickness="0" Background="Transparent" Padding="10" AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" VerticalContentAlignment="Top" Foreground="{StaticResource TextPrimary}" FontSize="13" Text="" />
                </Border>
                <Button Grid.Row="2" Style="{StaticResource SubtleButtonStyle}" Content="Save Notes" HorizontalAlignment="Right" Margin="0,10,0,0" Click="SaveNotesButton_Click"/>
            </Grid>
        </Border>
    </Grid>
</Page>